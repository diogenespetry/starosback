import{B as I,b as u,d as m,e as t,t as l,f as r,j as v,u as d,I as b,C as h,h as S,r as f,o as D,a as k,N as x,F as B,g as Q,k as $,l as Y,m as T,q as F,x as _,D as j,y as z}from"./index-BgI7K-Vp.js";import{Q as M}from"./QBadge-D59-Rg9Z.js";import{Q as H}from"./QSelect-Zjkj59qm.js";import{Q as R}from"./QForm-BB0dN-Hh.js";const q=I("TicketStore",{state:()=>({ticketSelecionado:null}),getters:{getTicketSelecionado:a=>a.ticketSelecionado},actions:{setTicketSelecionado(a){this.ticketSelecionado=a}}}),U={class:"tw:p-6 tw:bg-white tw:dark:bg-[#1F2A37] tw:rounded-lg tw:border tw:border-[#e5e7eb] tw:dark:border-[#2D3748]"},O={class:"q-mb-none tw:text-sm tw:text-gray-500 tw:dark:text-[#A0AEC0]"},P={__name:"_descricaoTicket",props:{ticket:{type:Object,default:()=>({})}},setup(a){const p=a;return(n,s)=>(m(),u("div",U,[s[0]||(s[0]=t("p",{class:"tw:text-xl tw:font-bold tw:text-gray-900 tw:dark:text-white"},"Descrição",-1)),t("p",O,l(p?.ticket?.description||"N/D"),1)]))}},L={class:"tw:p-6 tw:bg-white tw:dark:bg-[#1F2A37] tw:rounded-lg tw:border tw:border-[#e5e7eb] tw:dark:border-[#2D3748]"},G={class:"tw:flex tw:items-center tw:gap-1 tw:mb-1"},J={class:"q-mb-none tw:text-sm tw:text-gray-600 tw:dark:text-[#A0AEC0] tw:font-semibold"},K={key:0,class:"q-mb-none tw:text-sm tw:text-gray-600 tw:dark:text-[#A0AEC0] tw:font-semibold"},W={class:"tw:flex tw:items-center tw:gap-1 tw:mb-1"},X={class:"q-mb-none tw:text-sm tw:text-gray-600 tw:dark:text-[#A0AEC0] tw:font-semibold"},Z={class:"tw:flex tw:items-center tw:gap-1 tw:mb-1"},tt={__name:"_informacoesTicket",props:{ticket:{type:Object,default:()=>({})}},setup(a){function p(s){return S(s).format("DD/MM/YYYY, HH:mm")}function n(s){return{1:"blue",2:"orange",3:"yellow",4:"grey",5:"purple",6:"red"}[s]||"grey"}return(s,o)=>(m(),u("div",L,[o[3]||(o[3]=t("p",{class:"tw:text-xl tw:font-bold tw:text-gray-900 tw:dark:text-white"},"Informações",-1)),t("div",null,[t("div",G,[r(d(b),{icon:"tabler:building",class:"tw:text-lg tw:text-gray-600 tw:dark:text-white"}),o[0]||(o[0]=t("p",{class:"q-mb-none tw:text-[14px] tw:leading-[24px] tw:text-gray-600 tw:dark:text-white"},"Cliente",-1))]),t("p",J,l(a.ticket?.cliente?.nome||"N/D"),1),a.ticket?.cliente?.email?(m(),u("p",K," Email: "+l(a.ticket?.cliente.email||"N/D"),1)):v("",!0)]),r(h,{spaced:""}),t("div",null,[t("div",W,[r(d(b),{icon:"tabler:calendar-event",class:"tw:text-lg tw:text-gray-600 tw:dark:text-white"}),o[1]||(o[1]=t("p",{class:"q-mb-none tw:text-[14px] tw:leading-[24px] tw:text-gray-600 tw:dark:text-white"},"Data de Abertura",-1))]),t("p",X,l(p(a.ticket?.data_created)||"N/D"),1)]),r(h,{spaced:""}),t("div",null,[t("div",Z,[r(d(b),{icon:"tabler:flag",class:"tw:text-lg tw:text-gray-600 tw:dark:text-white"}),o[2]||(o[2]=t("p",{class:"q-mb-none tw:text-[14px] tw:leading-[24px] tw:text-gray-600 tw:dark:text-white"},"Status",-1))]),r(M,{color:n(a.ticket?.status_ticket?.id),label:a.ticket?.status_ticket?.name||"N/D",class:"tw:text-xs",style:{"font-weight":"500"},dense:""},null,8,["color","label"])])]))}},et={class:"tw:p-6 tw:bg-white tw:dark:bg-[#1F2A37] tw:rounded-lg tw:border tw:border-[#e5e7eb] tw:dark:border-[#2D3748]"},st={class:"tw:w-[32px] tw:h-[32px] tw:rounded-full tw:bg-[#eef4fe] tw:dark:bg-[#22334E] tw:flex tw:items-center tw:justify-center tw:flex-shrink-0"},ot={class:"q-mb-none tw:text-center tw:font-semibold tw:text-[12px] tw:text-[#3c83f6]"},at={class:"tw:flex-1 tw:min-w-0"},it={class:"tw:flex tw:justify-between tw:items-start tw:mb-2"},rt={class:"tw:flex tw:items-center tw:gap-2"},nt={class:"q-mb-none tw:text-sm tw:font-medium tw:text-gray-900 tw:dark:text-white"},lt={class:"q-mb-none tw:text-xs tw:text-gray-500 tw:dark:text-gray-400"},ct={class:"q-mb-none tw:text-sm tw:font-medium tw:text-gray-600 tw:dark:text-white tw:bg-gray-100 tw:dark:bg-[#2D3748] tw:px-2 tw:rounded-md"},dt={key:0},wt={class:"q-mb-none tw:text-sm tw:font-medium tw:text-[#65758b] tw:dark:text-gray-300"},ut={class:"tw:mt-12"},mt={class:"tw:flex tw:items-start tw:gap-3 tw:mt-3"},pt={class:"tw:flex-1"},gt={__name:"_interacoes",props:{ticket_id:{type:Number,default:()=>0}},setup(a){const p=q(),n=a,s=f(null),o=f([]),g=f([]),w=f({description:"",status_id:null});D(async()=>{await y(),await A()});async function y(){try{const e=await k.get(`/tickets/${n.ticket_id}/interacoes`);o.value=e.data}catch(e){console.log(e),x.create({message:e.response?.data?.message||"Erro ao buscar interações",color:"negative",position:"top"})}}async function A(){try{const e=await k.get("/status_tickets");g.value=e.data}catch(e){console.log(e),x.create({message:e.response?.data?.message||"Erro ao buscar status do ticket",color:"negative",position:"top"})}}async function C(){try{if(!w.value.description||!w.value.status_id){x.create({message:"Preencha todos os campos obrigatórios",color:"negative",position:"top"});return}if(s.value&&typeof s.value.validate=="function"&&!await s.value.validate())return;_.show({message:"Adicionando interação..."}),await k.post(`/tickets/${n.ticket_id}/interacoes`,w.value),await y(),await E(),s.value&&typeof s.value.validate=="function"&&(w.value.description="",w.value.status_id=null,await s.value.reset(),await s.value.resetValidation()),x.create({message:"Interação adicionada com sucesso!",color:"positive",position:"top"})}catch(e){console.log(e),x.create({message:e.response?.data?.message||"Erro ao adicionar interação",color:"negative",position:"top"})}finally{_.hide()}}async function E(){try{const e=await k.get(`/tickets/${n.ticket_id}`);p.setTicketSelecionado(e.data)}catch(e){console.log(e),x.create({message:e.response?.data?.message||"Erro ao atualizar ticket",color:"negative",position:"top"})}}function N(e){return S(e).format("DD/MM/YYYY HH:mm:ss")}return(e,c)=>(m(),u("div",et,[c[4]||(c[4]=t("p",{class:"tw:text-xl tw:font-bold tw:text-gray-900 tw:dark:text-white"},"Interações",-1)),(m(!0),u(B,null,Q(o.value,(i,V)=>(m(),u("div",{key:i.id,class:j(["tw:flex tw:items-start tw:gap-3 tw:py-4",{"tw:border-b tw:border-gray-200 tw:dark:border-gray-600":V<o.value.length-1}])},[t("div",st,[t("p",ot,l(i.usuario_nome?.substring(0,2)?.toUpperCase()||"ND"),1)]),t("div",at,[t("div",it,[t("div",rt,[t("p",nt,l(i.usuario_nome||"Usuário não identificado"),1),t("p",lt,l(N(i.date)||"Data não disponível"),1)]),t("p",ct,l(i.status_nome||"Status não disponível"),1)]),i.description?(m(),u("div",dt,[t("p",wt,l(i.description),1)])):v("",!0)])],2))),128)),t("div",ut,[c[2]||(c[2]=t("div",{class:"tw:border-b tw:border-gray-200 tw:dark:border-gray-600 tw:mb-3"},null,-1)),c[3]||(c[3]=t("p",{class:"q-mb-none tw:text-sm tw:font-semibold tw:text-gray-600 tw:dark:text-white"},"Adicionar interação",-1)),r(R,{onSubmit:F(C,["prevent"]),ref_key:"formRef",ref:s},{default:$(()=>[r(Y,{"input-style":{resize:"none"},modelValue:w.value.description,"onUpdate:modelValue":c[0]||(c[0]=i=>w.value.description=i),placeholder:"Digite seu comentário aqui...",dense:"",outlined:"",type:"textarea",color:"grey-5",rows:5,maxlength:2048,style:{margin:"8px 0",flex:"1",resize:"none"},rules:[i=>!!i||"Campo obrigatório"],"hide-bottom-space":""},null,8,["modelValue","rules"]),t("div",mt,[t("div",pt,[r(H,{modelValue:w.value.status_id,"onUpdate:modelValue":c[1]||(c[1]=i=>w.value.status_id=i),options:g.value,label:"Status do Ticket",rules:[i=>!!i||"Campo obrigatório"],"option-label":"name","option-value":"id","emit-value":"","map-options":"",dense:"",outlined:"",color:"grey-5",class:"tw:w-full"},null,8,["modelValue","options","rules"])]),r(T,{label:"Enviar",color:"blue-6","no-caps":"",type:"submit"})])]),_:1},512)])]))}},xt={class:"tw:min-h-screen tw:bg-gray-50 tw:dark:bg-[#0F1629]"},kt={key:0,class:"tw:container tw:mx-auto tw:py-[20px] tw:px-4 tw:sm:px-6 tw:lg:px-8"},ft={class:"tw:flex tw:items-center tw:gap-4"},bt={class:"q-mb-none tw:text-[30px] tw:font-bold"},_t={class:"q-mb-none tw:text-[16px] tw:leading-[24px]"},vt={class:"tw:mt-4 tw:flex tw:flex-row tw:gap-4 tw:flex-1 tw:min-h-0 tw:overflow-hidden"},yt={class:"tw:w-full tw:md:w-[60%] tw:flex tw:flex-col tw:gap-4"},ht={class:"tw:w-full tw:md:w-[40%]"},qt={__name:"InteracoesTicket",setup(a){const p=z(),n=q();D(async()=>{_.show({message:"Carregando dados do ticket..."});const o=p.currentRoute.value.params.id;await s(o),_.hide()});async function s(o){try{const g=await k.get(`/tickets/${o}`);n.setTicketSelecionado(g.data)}catch(g){p.push("/tickets"),console.log(g),x.create({message:g.response?.data?.message||"Erro ao atualizar ticket",color:"negative",position:"top"})}}return(o,g)=>(m(),u("div",xt,[d(n)?.getTicketSelecionado?.id?(m(),u("div",kt,[t("div",ft,[r(T,{flat:"",dense:"",color:"blue-6",to:"/tickets"},{default:$(()=>[r(d(b),{icon:"tabler:chevron-left",class:"tw:text-3xl"})]),_:1}),t("div",null,[t("p",bt,l(d(n)?.getTicketSelecionado?.title||"N/D"),1),t("p",_t," Ticket #"+l(d(n)?.getTicketSelecionado?.id||"0"),1)])]),t("div",vt,[t("div",yt,[r(P,{ticket:d(n)?.getTicketSelecionado},null,8,["ticket"]),r(gt,{ticket_id:d(n)?.getTicketSelecionado?.id},null,8,["ticket_id"])]),t("div",ht,[r(tt,{ticket:d(n)?.getTicketSelecionado},null,8,["ticket"])])])])):v("",!0)]))}};export{qt as default};
