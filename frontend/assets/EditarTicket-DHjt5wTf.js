import{z as V,y as C,r as i,o as h,N as d,a as p,b as E,d as N,e as t,f as l,k as r,u as q,I,m,l as g,q as Q}from"./index-BgI7K-Vp.js";import{Q as B,a as R,b as S}from"./QSelect-Zjkj59qm.js";import{Q as T}from"./QForm-BB0dN-Hh.js";const z={class:"tw:container tw:mx-auto tw:py-[20px] tw:px-4 tw:sm:px-6 tw:lg:px-8"},D={class:"tw:flex tw:items-center tw:gap-4"},F={class:"tw:mt-4 tw:border tw:border-gray-200 tw:rounded-xl tw:px-4 tw:py-4 tw:dark:bg-[#1F2A37] tw:dark:border-0"},U={class:"row q-col-gutter-md tw:my-4"},L={class:"col-6"},M={class:"col-6"},O={class:"row q-col-gutter=md tw:my-4"},$={class:"col-12"},j={class:"row justify-end q-gutter-sm q-mt-md"},J={__name:"EditarTicket",setup(A){const x=V(),f=C(),w=i(null),v=i(!1),c=i(!1),n=i([]),u=i([]),s=i({title:"",description:"",status:"",cliente_id:void 0});h(async()=>{try{const o=x.params.id;if(!o||isNaN(o)){d.create({type:"negative",message:"ID do ticket inválido!",position:"top"}),f.push("/tickets");return}const{data:e}=await p.get(`/tickets/${o}`);s.value=e,await y()}catch(o){console.error("Erro ao carregar cliente:",o)}});async function y(){try{c.value=!0;const o=await p.get("clientes");n.value=o.data,u.value=o.data}catch(o){console.error("Erro ao carregar clientes:",o),d.create({message:"Erro ao carregar clientes",color:"negative",position:"top"})}finally{c.value=!1}}function b(o,e){e(()=>{if(o==="")n.value=u.value;else{const a=o.toLowerCase();n.value=u.value.filter(_=>_.nome.toLowerCase().indexOf(a)>-1)}})}async function k(){if(v.value)return;if(!await w.value.validate()){d.create({type:"negative",message:"Preencha os campos obrigatórios corretamente!",position:"top"});return}try{await p.put(`/tickets/${s.value.id}`,s.value),f.push("/tickets")}catch(e){console.error("Erro ao editar cliente:",e),d.create({message:"Não foi possível editar o cliente",color:"negative",position:"top",timeout:4e3})}}return(o,e)=>(N(),E("div",null,[t("div",z,[t("div",D,[l(m,{flat:"",dense:"",color:"blue-6",to:"/tickets"},{default:r(()=>[l(q(I),{icon:"tabler:chevron-left",class:"tw:text-3xl"})]),_:1}),e[3]||(e[3]=t("div",null,[t("p",{class:"q-mb-none tw:text-[30px] tw:font-bold"},"Editar Ticket"),t("p",{class:"q-mb-none tw:text-[16px] tw:leading-[24px]"},"Edite as informações do ticket")],-1))]),t("div",F,[e[8]||(e[8]=t("p",{class:"q-mb-none tw:text-[20px] tw:font-bold tw:text-[#292a2e] tw:dark:text-[#bfc1c4]"}," Informações do Ticket ",-1)),l(T,{style:{margin:"12px 0"},onSubmit:Q(k,["prevent"]),ref_key:"formRef",ref:w},{default:r(()=>[t("div",U,[t("div",L,[e[4]||(e[4]=t("label",{class:"tw:text-gray-500 tw:dark:text-gray-200"},"Título *",-1)),l(g,{modelValue:s.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.title=a),placeholder:"Digite o título do ticket",outlined:"",dense:"",rules:[a=>!!a||"Campo obrigatório"],"hide-bottom-space":""},null,8,["modelValue","rules"])]),t("div",M,[e[6]||(e[6]=t("label",{class:"tw:text-gray-500 tw:dark:text-gray-200"},"Cliente (opcional)",-1)),l(B,{modelValue:s.value.cliente_id,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.cliente_id=a),options:n.value,"option-label":"nome","option-value":"id","emit-value":"","map-options":"",dense:"",outlined:"",placeholder:"Vincule a um cliente","no-option-found-label":"Nenhum cliente encontrado",loading:c.value,clearable:"","use-input":"","input-debounce":"300",onFilter:b},{"no-option":r(()=>[l(R,null,{default:r(()=>[l(S,{class:"text-grey"},{default:r(()=>[...e[5]||(e[5]=[t("div",null,[t("div",{class:"text-body2"},"Nenhum cliente encontrado")],-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","loading"])])]),t("div",O,[t("div",$,[e[7]||(e[7]=t("label",{class:"tw:text-gray-500 tw:dark:text-gray-200"},"Descrição",-1)),l(g,{"input-style":{resize:"none"},modelValue:s.value.description,"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.description=a),placeholder:"Informe uma descrição...",dense:"",outlined:"",type:"textarea",color:"grey-5",rows:5,maxlength:2048,style:{margin:"8px 0",flex:"1",resize:"none"},rules:[a=>!!a||"Campo obrigatório"],"hide-bottom-space":""},null,8,["modelValue","rules"])])]),t("div",j,[l(m,{label:"Cancelar",flat:"",to:"/tickets"}),l(m,{label:"Salvar",color:"primary",type:"submit",outlined:"",loading:v.value,icon:"check"},null,8,["loading"])])]),_:1},512)])])]))}};export{J as default};
