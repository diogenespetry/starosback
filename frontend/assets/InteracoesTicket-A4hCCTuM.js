import{B,b as m,d as p,e as t,t as c,f as r,j as y,u,I as _,C as h,h as S,c as Q,r as b,o as D,A as $,a as k,N as x,F as Y,g as z,k as T,l as F,m as A,q as j,x as f,D as M,y as H,z as R}from"./index-BkiFMBGU.js";import{Q as U}from"./QBadge-BjeV1qq6.js";import{Q as O}from"./QSelect-0dw-sqvU.js";import{Q as P}from"./QForm-QQlO4h6a.js";const q=B("TicketStore",{state:()=>({ticketSelecionado:null}),getters:{getTicketSelecionado:n=>n.ticketSelecionado},actions:{setTicketSelecionado(n){this.ticketSelecionado=n}}}),L={class:"tw:p-6 tw:bg-white tw:dark:bg-[#1F2A37] tw:rounded-lg tw:border tw:border-[#e5e7eb] tw:dark:border-[#2D3748]"},G={class:"q-mb-none tw:text-sm tw:text-gray-500 tw:dark:text-[#A0AEC0]"},J={__name:"_descricaoTicket",props:{ticket:{type:Object,default:()=>({})}},setup(n){const g=n;return(l,e)=>(p(),m("div",L,[e[0]||(e[0]=t("p",{class:"tw:text-xl tw:font-bold tw:text-gray-900 tw:dark:text-white"},"Descrição",-1)),t("p",G,c(g?.ticket?.description||"N/D"),1)]))}},K={class:"tw:p-6 tw:bg-white tw:dark:bg-[#1F2A37] tw:rounded-lg tw:border tw:border-[#e5e7eb] tw:dark:border-[#2D3748]"},W={class:"tw:flex tw:items-center tw:gap-1 tw:mb-1"},X={class:"q-mb-none tw:text-sm tw:text-gray-600 tw:dark:text-[#A0AEC0] tw:font-semibold"},Z={key:0,class:"q-mb-none tw:text-sm tw:text-gray-600 tw:dark:text-[#A0AEC0] tw:font-semibold"},tt={class:"tw:flex tw:items-center tw:gap-1 tw:mb-1"},et={class:"q-mb-none tw:text-sm tw:text-gray-600 tw:dark:text-[#A0AEC0] tw:font-semibold"},st={class:"tw:flex tw:items-center tw:gap-1 tw:mb-1"},at={__name:"_informacoesTicket",props:{ticket:{type:Object,default:()=>({})}},setup(n){function g(e){return S(e).format("DD/MM/YYYY, HH:mm")}function l(e){return{1:"blue",2:"orange",3:"yellow",4:"grey",5:"purple",6:"red"}[e]||"grey"}return(e,a)=>(p(),m("div",K,[a[3]||(a[3]=t("p",{class:"tw:text-xl tw:font-bold tw:text-gray-900 tw:dark:text-white"},"Informações",-1)),t("div",null,[t("div",W,[r(u(_),{icon:"tabler:building",class:"tw:text-lg tw:text-gray-600 tw:dark:text-white"}),a[0]||(a[0]=t("p",{class:"q-mb-none tw:text-[14px] tw:leading-[24px] tw:text-gray-600 tw:dark:text-white"},"Cliente",-1))]),t("p",X,c(n.ticket?.cliente?.nome||"N/D"),1),n.ticket?.cliente?.email?(p(),m("p",Z," Email: "+c(n.ticket?.cliente.email||"N/D"),1)):y("",!0)]),r(h,{spaced:""}),t("div",null,[t("div",tt,[r(u(_),{icon:"tabler:calendar-event",class:"tw:text-lg tw:text-gray-600 tw:dark:text-white"}),a[1]||(a[1]=t("p",{class:"q-mb-none tw:text-[14px] tw:leading-[24px] tw:text-gray-600 tw:dark:text-white"},"Data de Abertura",-1))]),t("p",et,c(g(n.ticket?.data_created)||"N/D"),1)]),r(h,{spaced:""}),t("div",null,[t("div",st,[r(u(_),{icon:"tabler:flag",class:"tw:text-lg tw:text-gray-600 tw:dark:text-white"}),a[2]||(a[2]=t("p",{class:"q-mb-none tw:text-[14px] tw:leading-[24px] tw:text-gray-600 tw:dark:text-white"},"Status",-1))]),r(U,{color:l(n.ticket?.status_ticket?.id),label:n.ticket?.status_ticket?.name||"N/D",class:"tw:text-xs",style:{"font-weight":"500"},dense:""},null,8,["color","label"])])]))}},ot={class:"tw:p-6 tw:bg-white tw:dark:bg-[#1F2A37] tw:rounded-lg tw:border tw:border-[#e5e7eb] tw:dark:border-[#2D3748]"},it={class:"tw:w-[32px] tw:h-[32px] tw:rounded-full tw:bg-[#eef4fe] tw:dark:bg-[#22334E] tw:flex tw:items-center tw:justify-center tw:flex-shrink-0"},rt={class:"q-mb-none tw:text-center tw:font-semibold tw:text-[12px] tw:text-[#3c83f6]"},nt={class:"tw:flex-1 tw:min-w-0"},lt={class:"tw:flex tw:justify-between tw:items-start tw:mb-2"},ct={class:"tw:flex tw:items-center tw:gap-2"},dt={class:"q-mb-none tw:text-sm tw:font-medium tw:text-gray-900 tw:dark:text-white"},wt={class:"q-mb-none tw:text-xs tw:text-gray-500 tw:dark:text-gray-400"},ut={class:"q-mb-none tw:text-sm tw:font-medium tw:text-gray-600 tw:dark:text-white tw:bg-gray-100 tw:dark:bg-[#2D3748] tw:px-2 tw:rounded-md"},mt={key:0},pt={class:"q-mb-none tw:text-sm tw:font-medium tw:text-[#65758b] tw:dark:text-gray-300"},gt={class:"tw:mt-12"},xt={class:"tw:flex tw:items-start tw:gap-3 tw:mt-3"},ft={class:"tw:flex-1"},kt={__name:"_interacoes",setup(n){const g=q(),l=Q(()=>g?.getTicketSelecionado?.id||null),e=b(null),a=b([]),d=b([]),o=b({description:"",status_id:null});D(async()=>{await v(),await C()}),$(()=>l.value,async s=>{if(!s){a.value=[];return}await v()});async function v(){try{if(!l.value)return;const s=await k.get(`/tickets/${l.value}/interacoes`);a.value=s.data}catch(s){console.log(s),x.create({message:s.response?.data?.message||"Erro ao buscar interações",color:"negative",position:"top"})}}async function C(){try{const s=await k.get("/status_tickets");d.value=s.data}catch(s){console.log(s),x.create({message:s.response?.data?.message||"Erro ao buscar status do ticket",color:"negative",position:"top"})}}async function E(){try{if(!o.value.description||!o.value.status_id){x.create({message:"Preencha todos os campos obrigatórios",color:"negative",position:"top"});return}if(e.value&&typeof e.value.validate=="function"&&!await e.value.validate())return;f.show({message:"Adicionando interação..."}),await k.post(`/tickets/${l.value}/interacoes`,o.value),await v(),await N(),e.value&&typeof e.value.validate=="function"&&(o.value.description="",o.value.status_id=null,await e.value.reset(),await e.value.resetValidation()),x.create({message:"Interação adicionada com sucesso!",color:"positive",position:"top"})}catch(s){console.log(s),x.create({message:s.response?.data?.message||"Erro ao adicionar interação",color:"negative",position:"top"})}finally{f.hide()}}async function N(){try{const s=await k.get(`/tickets/${l.value}`);g.setTicketSelecionado(s.data)}catch(s){console.log(s),x.create({message:s.response?.data?.message||"Erro ao atualizar ticket",color:"negative",position:"top"})}}function V(s){return S(s).format("DD/MM/YYYY HH:mm:ss")}return(s,w)=>(p(),m("div",ot,[w[4]||(w[4]=t("p",{class:"tw:text-xl tw:font-bold tw:text-gray-900 tw:dark:text-white"},"Interações",-1)),(p(!0),m(Y,null,z(a.value,(i,I)=>(p(),m("div",{key:i.id,class:M(["tw:flex tw:items-start tw:gap-3 tw:py-4",{"tw:border-b tw:border-gray-200 tw:dark:border-gray-600":I<a.value.length-1}])},[t("div",it,[t("p",rt,c(i.usuario_nome?.substring(0,2)?.toUpperCase()||"ND"),1)]),t("div",nt,[t("div",lt,[t("div",ct,[t("p",dt,c(i.usuario_nome||"Usuário não identificado"),1),t("p",wt,c(V(i.date)||"Data não disponível"),1)]),t("p",ut,c(i.status_nome||"Status não disponível"),1)]),i.description?(p(),m("div",mt,[t("p",pt,c(i.description),1)])):y("",!0)])],2))),128)),t("div",gt,[w[2]||(w[2]=t("div",{class:"tw:border-b tw:border-gray-200 tw:dark:border-gray-600 tw:mb-3"},null,-1)),w[3]||(w[3]=t("p",{class:"q-mb-none tw:text-sm tw:font-semibold tw:text-gray-600 tw:dark:text-white"},"Adicionar interação",-1)),r(P,{onSubmit:j(E,["prevent"]),ref_key:"formRef",ref:e},{default:T(()=>[r(F,{"input-style":{resize:"none"},modelValue:o.value.description,"onUpdate:modelValue":w[0]||(w[0]=i=>o.value.description=i),placeholder:"Digite seu comentário aqui...",dense:"",outlined:"",type:"textarea",color:"grey-5",rows:5,maxlength:2048,style:{margin:"8px 0",flex:"1",resize:"none"},rules:[i=>!!i||"Campo obrigatório"],"hide-bottom-space":""},null,8,["modelValue","rules"]),t("div",xt,[t("div",ft,[r(O,{modelValue:o.value.status_id,"onUpdate:modelValue":w[1]||(w[1]=i=>o.value.status_id=i),options:d.value,label:"Status do Ticket",rules:[i=>!!i||"Campo obrigatório"],"option-label":"name","option-value":"id","emit-value":"","map-options":"",dense:"",outlined:"",color:"grey-5",class:"tw:w-full"},null,8,["modelValue","options","rules"])]),r(A,{label:"Enviar",color:"blue-6","no-caps":"",type:"submit"})])]),_:1},512)])]))}},bt={class:"tw:min-h-screen tw:bg-gray-50 tw:dark:bg-[#0F1629]"},_t={key:0,class:"tw:container tw:mx-auto tw:py-[20px] tw:px-4 tw:sm:px-6 tw:lg:px-8"},vt={class:"tw:flex tw:items-center tw:gap-4"},yt={class:"q-mb-none tw:text-[30px] tw:font-bold"},ht={class:"q-mb-none tw:text-[16px] tw:leading-[24px]"},St={class:"tw:mt-4 tw:flex tw:flex-row tw:gap-4 tw:flex-1 tw:min-h-0 tw:overflow-hidden"},Dt={class:"tw:w-full tw:md:w-[60%] tw:flex tw:flex-col tw:gap-4"},$t={class:"tw:w-full tw:md:w-[40%]"},Et={__name:"InteracoesTicket",setup(n){const g=H(),l=R(),e=q();D(async()=>{f.show({message:"Carregando dados do ticket..."});const d=l.params.id;await a(d),f.hide()}),$(()=>l.params.id,async d=>{d&&(f.show({message:"Carregando dados do ticket..."}),await a(d),f.hide())});async function a(d){try{const o=await k.get(`/tickets/${d}`);e.setTicketSelecionado(o.data)}catch(o){g.push("/tickets"),console.log(o),x.create({message:o.response?.data?.message||"Erro ao atualizar ticket",color:"negative",position:"top"})}}return(d,o)=>(p(),m("div",bt,[u(e)?.getTicketSelecionado?.id?(p(),m("div",_t,[t("div",vt,[r(A,{flat:"",dense:"",color:"blue-6",to:"/tickets"},{default:T(()=>[r(u(_),{icon:"tabler:chevron-left",class:"tw:text-3xl"})]),_:1}),t("div",null,[t("p",yt,c(u(e)?.getTicketSelecionado?.title||"N/D"),1),t("p",ht," Ticket #"+c(u(e)?.getTicketSelecionado?.id||"0"),1)])]),t("div",St,[t("div",Dt,[r(J,{ticket:u(e)?.getTicketSelecionado},null,8,["ticket"]),r(kt)]),t("div",$t,[r(at,{ticket:u(e)?.getTicketSelecionado},null,8,["ticket"])])])])):y("",!0)]))}};export{Et as default};
