import{s as I,c as N,P as V,y as B,r,o as E,a as v,A as P,b as F,d as L,e as o,f as l,m as f,k as s,u as m,p as k,I as _,t as y,n as $,h as M}from"./index-BgI7K-Vp.js";import{Q as z}from"./QSelect-Zjkj59qm.js";import{Q as w,a as G}from"./QTable-DZi4_uj_.js";import{Q as R}from"./QBadge-D59-Rg9Z.js";const U={class:"tw:container tw:mx-auto tw:py-[20px] tw:px-4 tw:sm:px-6 tw:lg:px-8"},H={class:"tw:flex tw:items-center tw:justify-between"},J={class:"tw:my-4"},K={class:"row q-col-gutter-md tw:my-4"},W={class:"col-3"},X={class:"q-mb-none"},Y={class:"q-mb-none tw:font-semibold"},Z={class:"tw:flex tw:gap-2"},oe={__name:"ListaTickets",setup(j){const x=I(),c=N(()=>V.isActive),C=B(),p=r([]),u=r([]),i=r([]),n=r(null),d=r(!1),q=r([{name:"Id",required:!0,label:"# ID",align:"left",field:e=>e.id},{name:"Titulo",required:!0,label:"Titulo",align:"left",field:e=>e.title},{name:"Descrição",required:!0,label:"Descrição",align:"left",field:e=>e.description},{name:"Cliente",required:!0,label:"Cliente",align:"left",field:e=>e?.cliente?.nome||""},{name:"CriadoPor",required:!0,label:"Criado Por",align:"left",field:e=>e.usuario.name},{name:"DataCriado",required:!0,label:"Data criado",align:"left",field:e=>e.data_created},{name:"StatusTicket",required:!0,label:"Status",align:"left",field:e=>e.status_ticket},{name:"Acoes",label:"",align:"left"}]);E(async()=>{await b(),await h()});async function b(){try{d.value=!0;const e={};n.value&&(e.cliente_id=n.value);const t=await v.get("/tickets",{params:e});p.value=t.data}catch(e){console.error("Erro ao buscar ticket:",e)}finally{d.value=!1}}async function h(){try{const e=await v.get("/clientes");u.value=e.data,i.value=e.data}catch(e){console.error("Erro ao buscar clientes:",e)}}function S(e,t){if(e===""){t(()=>{i.value=u.value});return}t(()=>{const a=e.toLowerCase();i.value=u.value.filter(g=>g.nome.toLowerCase().indexOf(a)>-1)})}P(n,()=>{b()});function T(e){return e?M(e).format("lll"):""}function D(e){return e&&e.name?e.name:"Desconhecido"}function A(e){if(!e||!e.id)return"grey";switch(e.id){case 1:return"orange";case 2:return"green";case 3:return"blue";default:return"grey"}}function Q(e){C.push(`/tickets/${e.id}/interacoes`)}return(e,t)=>(L(),F("div",null,[o("div",U,[o("div",H,[t[1]||(t[1]=o("div",null,[o("p",{class:"q-mb-none tw:text-[30px] tw:font-bold"},"Ticket"),o("p",{class:"q-mb-none tw:text-[16px] tw:leading-[24px]"},"Gerencie todos os tickets de suporte")],-1)),l(f,{label:"Novo Ticket",color:"blue-6",to:"/tickets/cadastrar"})]),o("div",J,[o("div",K,[o("div",W,[t[2]||(t[2]=o("label",{class:"tw:text-gray-500 tw:dark:text-gray-200"},"Selecione o cliente",-1)),l(z,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value=a),options:i.value,label:"Filtrar por cliente",outlined:"",dense:"",clearable:"",class:"tw:w-full sm:tw:w-64",dark:c.value,"option-label":"nome","option-value":"id","emit-value":"","map-options":"","use-input":"",onFilter:S},null,8,["modelValue","options","dark"])])]),l(G,{bordered:!c.value,flat:"",style:$([{"border-radius":"12px"},c.value?"border: none; background-color: #1F2A37":""]),rows:p.value,columns:q.value,loading:d.value,"no-data-label":"Nenhum ticket encontrado"},{"body-cell-DataCriado":s(a=>[l(w,{props:a},{default:s(()=>[o("p",X,y(T(a.row.data_created)),1)]),_:2},1032,["props"])]),"body-cell-StatusTicket":s(a=>[l(w,{props:a},{default:s(()=>[l(R,{color:A(a.row.status_ticket)},{default:s(()=>[o("p",Y,y(D(a.row.status_ticket)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-Acoes":s(a=>[l(w,{props:a},{default:s(()=>[o("div",Z,[l(f,{flat:"",color:"blue-6",to:`/tickets/${a.row.id}/editar`,disable:a.row.usuario_id!==m(x).getMe().id},{default:s(()=>[l(m(_),{icon:"hugeicons:license-draft",class:"q-mr-sm"}),t[3]||(t[3]=k(" Editar ",-1))]),_:1},8,["to","disable"]),l(f,{flat:"",color:"blue-6",onClick:g=>Q(a.row)},{default:s(()=>[l(m(_),{icon:"hugeicons:message-02",class:"q-mr-sm"}),t[4]||(t[4]=k(" Interações ",-1))]),_:1},8,["onClick"])])]),_:2},1032,["props"])]),_:1},8,["bordered","style","rows","columns","loading"])])])]))}};export{oe as default};
